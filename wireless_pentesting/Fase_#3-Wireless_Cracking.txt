
Wireless Security Protocols available:

 - Open
 - WEP  (Wired Equivalent Protocol)
 - WPA  (Wi-Fi Protected Access)
 - WPA2 (Wi-Fi Protected Access II)

Por su uso extendido nos centraremos en: WPA y WPA2

########################
## Cracking WPA ########
########################

       --------------------------------------------------------------------------------------------------------------------------------------------------------------
       | 1 | Breve descripción																	    |
       --------------------------------------------------------------------------------------------------------------------------------------------------------------
	
	WPA is an implementation of the IEEE 802.11i standard. Temporal Key Integrity Protocol (TKIP) was introduced in WPA to overcome the drawbacks in WEP.
	
	Hay dos tipos de WPA:
	
	  - WPA Personal
	  - WPA Enterprise

                     
	############################
        ## A) WPA Personal #########
        ############################
	
	WPA Personal, also called "WPA Pre Shared Key (PSK)", is the most common authentication method used on wireless networks today. It is the standard for residential 
	implementations and SMBs have also found it easy to implement.

	Residential and small business tend to use WPA PSK, in part because of the administrative overhead of "WPA Enterprise". Whereas "WPA PSK" uses a single shared key 
	for authentication, TKIP is used to generate unique encryption keys whenever a client connects to the network. These per-session keys increase the security of the 
	communication between the wireless client and the access point. In a typical "WPA PSK" setup, wireless administrators configure the "WPA PSK" key on each of the APs 
	or on the controller and then distribute the key to employees in their organization. The key will remain the same for all the employees; there are some advantages 
	and disadvantages in using this kind of solution.
	
	Password Length: The minimum password length of the WPA PSK key is eight ASCII characters.
	
        -------------------------------------------------------------------------------------------------------------------------------------------------------------------
        | A-1 | Steps involved in the authentication method														  |
        -------------------------------------------------------------------------------------------------------------------------------------------------------------------
	
	   1) - Each user is given a password to authenticate to the network; those who have this password can access the network. 
	      - This password is also called "Pre-shared
	        master key (PMK)", is the same for all users.
	      
	   2) - By using this PMK a transiente/temporal key is generated between the client and AP (Access Point) for every new session. 
	      - Pairwise Transient/Temporal Keys (PTK) are used to ENCRYPT the data and the "key" is valid until the session ends.

        -------------------------------------------------------------------------------------------------------------------------------------------------------------------
        | A-2 | Risks																			  |
        -------------------------------------------------------------------------------------------------------------------------------------------------------------------
	 
	  - Even if the attacker has knowledge of the PMK used in the network, he cannot decrypt the packets without calculating the temporal key (PTK).
	  - To determine the PTK, the attacker will also need to capture the "handshake" between the wireless client and the AP during the initiation of a new session.
	  - The PSK is vulnerable to dictionary attack. The captured traffic should also contain "four-way hanshake packets".
	  
	  
	-------------------------------------------------------------------------------------------------------------------------------------------------------------------
        | A-3 | Example																			  |
        -------------------------------------------------------------------------------------------------------------------------------------------------------------------

	    1) Bring the card up and create a "monitor mode interface" on the wireless card:
	
	       >ifconfig wlan0 up
	       >airmon-ng start wlan0
	       
	    2) Make sure the WLAN interface is up and running. Once confirmed, start airmon-ng to create a monitor mode interface by using the following command:

               >airmon-ng start wlan0
	 
	    3) Once you have created the "monitor mode interface", scan the air for available wireless networks by using "airodump-ng". airodump-ng will scan all the 14
	       channels in 2.4 Ghz frequency and show the list of wireless access points in range.

	       >airodump-ng mon0

	    4) Capture the "four-way-handshake": 
	    
	       To increase the likelihood that you are able to capture the data that you are looking for, it is recommended that you identify the channel that the AP is 
	       communicating on and limit your radio to listen on that channel. The following command has been constructed to specify the name of the file to save the 
	       capture, channel to sniff, and finally the interface to use, which should be a monitor mode interface:
	       
	       >airodump-ng -w labfiles/wpacrack/wpa-Seclab -c 9 mon0
	       
	          -c:  Specifies the channel to sniff.
	          -w:  Specifies the file to save the captured data.
	          
	    5) Capture the "four-way-handshake" (Cont.):
	     
	       Once a client connects to the wireless network, airodump-ng is looking to capture the "four-way handshake". After the capture of this handshake is complete, 
	       we are able to see this indicated in the airodump-ng output at the top-right corner, as seen in the following screenshot.
	        
	     
	    6) After capturing the "four-way handshake", it is now time to crack the key using a wordlist. Kali Linux contains a default wordlist. Use "aircrack-ng" to crack 
	       the key using that dictionary:
	       
	       >aircrack-ng labfiles/wpacrack/wpa-Seclab-01.cap –w /usr/share/wordlists/rockyou.txt


########################
## Cracking WPA2 #######
########################
