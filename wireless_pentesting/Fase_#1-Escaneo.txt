Dentro de este apartado describimos las herramientas y el uso de las mismas para la fase de ESCANEO:


#######################
## Airodump-ng ########
#######################

       --------------------------------------------------------------------------------------------------------------------------------------------------------------
       | 1 | Breve descripción																	    |
       --------------------------------------------------------------------------------------------------------------------------------------------------------------

	 - Part of the "Aircrack-ng" suite; extensively used to penetrate wireless 802.11 networks.
	 - Airdump-ng captures raw 802.11 frames from the wireless medium in the vicinity.
	 - Also captures weak IV (Initialization Vectors) that are used in cracking WEP key.
	 - Generated output files:
	       - pcap
	       - ivs
	       - csv
	       - gps
	       - kismet
	       - netxml
      
       --------------------------------------------------------------------------------------------------------------------------------------------------------------
       | 2 | Simple scan																	    |
       --------------------------------------------------------------------------------------------------------------------------------------------------------------

	Para llevar a cabo un simple escaneo, haremos lo siguiente:
	
	    1) Bring the wireless up and running with the following command:
	    
	       >ifconfig wlan0 up
	       
	    2) Arrancamos "Airmon-ng" para crear un interfaz en "monitor mode":
	    
	       >airmon-ng start wlan0
	       
	       El resultado será la creación de una nueva interfaz llamda: mon0
	       
	    3) Ejecutamos "Airodump-ng" indicándole el interfaz en "monitor mode" que acabamos de crear:
	    
	       >airodump-ng -w dump -c 11 wlan0mon
	       
	            -w dump ==> Con esto le indicamos que el resultado lo guarde en un fichero llamado "dump".
	            -c 11   ==> Con esto le indicamos que analice el tráfico en el canal 11.

	    NOTA: Si vemos que no saca nada, lo que tendremos que hacer es lo siguiente:
	    
	            >ifconfig wlan0mon down
	            >iwconfig wlan0mon mode monitor
	            >ifconfig wlan0mon up
	           

       --------------------------------------------------------------------------------------------------------------------------------------------------------------
      | 3 | Simple scan + filtering flags															    |
       --------------------------------------------------------------------------------------------------------------------------------------------------------------

	Podemos llevar a cabo un escaneo más específico añadiendo mas "flags" en el comando:
	
	  --bssid        ==> Con esta opción le indicaremos que solamente analice el tráfico proveniente del AP cuya BSSID sea "nombre_bssid".
	  --manufacturer ==> Nos devuelve el nombre del fabricante de los AP. El comando sería:
	  
	                        >airodump-ng --manufacturer mon0
	                        
	Otros ejemplos:
	
	  El siguiente ejemplo muestra únicamente el tráfico enviado desde/hacia un AP concreto indicado a través del "flag" --bssid. Además utilizamos el "flag" ESSID para indicar el 
	  nombre de la red que estamos monitorizando:
	  
	     >airodump-ng --essid Internet --bssid XX:XX:XX:XX:XX:XX:XX:XX mon0

#######################
## Airgraph-ng ########
#######################

       --------------------------------------------------------------------------------------------------------------------------------------------------------------
       | 1 | Breve descripción																	    |
       --------------------------------------------------------------------------------------------------------------------------------------------------------------

	Con esta herramienta podremos visualizar de manera gráfica el/los fichero(s) obtenido(s) como resultado de "Airodump-ng".

	"Airodump-ng" genera los siguientes ficheros:

	  -dump-01-cap		 => El fichero ".cap" puede ser importado en programas como: Wireshark  
	  -dump-01.csv		 => Este fichero contiene la información mostrada por consola al ejecutar "Airodump-ng".
	  -dump-01.kismet.csv
	  -dump-01.kismet.netxml

       --------------------------------------------------------------------------------------------------------------------------------------------------------------
       | 2 | Instalación																	    |
       --------------------------------------------------------------------------------------------------------------------------------------------------------------
  
	"Airgraph-ng" NO viene instalada en Kali. Para instalarlo seguiremos los siguientes pasos:

	  1) Descargamos el código de "aircrack-ng" con el siguiente comando:
  
	     >svn co http://svn.aircrack-ng.org/trunk/scripts/airgraph-ng
     
	  2) Damos permisos de ejecución al programa:
  
	     >cd airgraph-ng
	     >chmod +x airgraph-ng

       --------------------------------------------------------------------------------------------------------------------------------------------------------------
       | 3 | ¿Cómo utilizar Airgraph-ng?															    |
       --------------------------------------------------------------------------------------------------------------------------------------------------------------

	"Airgraph-ng" utiliza los ficheros ".csv" generados por "airodump-ng" para generar ficheros ".png" con la representación de los AP y los clientes asociados a estos.
	Para elo, ejecutaremos el siguiente comando:
	
	  >airgraph-ng -i ../dump-01.csv -o ../dump-01.png -g CAPR
	  
	   _______________________________________________________________________
	  |	     |							          |
	  |    -i    | The input file, .csv, from your capture with airodump-ng.  |
	  |__________|____________________________________________________________|
	  |	     |								  |
	  |    -o    | The output file where the .png file will be created.	  |
	  |__________|____________________________________________________________|
	  |	     |								  |
	  |    -g    | Graph type: you can either choose:			  |
	  |          |	 - CAPR: Client to AP Relationship			  |
	  |	     |   - CPG: Common Probe Graph				  |
	  |__________|____________________________________________________________|

#######################
## Hoover #############
#######################

       --------------------------------------------------------------------------------------------------------------------------------------------------------------
       | 1 | Breve descripción																	    |
       --------------------------------------------------------------------------------------------------------------------------------------------------------------
	
	- Herramienta que nos permite conocer las redes a las que un cliente ha estado asociado anteriormente.
	- Nos permite encontrar un cliente que esté buscando un AP al cual re-conectarse de tal manera que tengamos la oportunidad de capturar dicha petición y realizar un ataque MITM.

       --------------------------------------------------------------------------------------------------------------------------------------------------------------
       | 2 | Instalación																	    |
       --------------------------------------------------------------------------------------------------------------------------------------------------------------

	Nos descargaremos el script "hoover.pl" y el "readme" asociado de la siguiente manera:

	>git clone http://github.com/xme/hoover

       --------------------------------------------------------------------------------------------------------------------------------------------------------------
       | 3 | ¿Cómo utilizar Hoover?																    |
       --------------------------------------------------------------------------------------------------------------------------------------------------------------

	Entramos al directorio /root/hoover y ejecutamos el script "hoover.pl" con las siguientes opciones:

	       ____________________________________________________________________________
	      |			|							   |
	      |  --interface	|   The capture interface (normally, mon0 or wlan0mon).    |
	      |_________________|__________________________________________________________|
	      |		        |							   |
	      |	 --tshark-path	|   Where tshark is installed (on Kali 2.0, this is in	   |
	      |			|   "/usr/bin/tshark".				           |
              |_________________|__________________________________________________________|	

	Ejemplo:

           >hoover.pl --interface wlan0mon --tshark-path /usr/bin/tshark


#######################
## Wash ###############
#######################

       --------------------------------------------------------------------------------------------------------------------------------------------------------------
       | 1 | Breve descripción																	    |
       --------------------------------------------------------------------------------------------------------------------------------------------------------------
	
	- WPS (Wireless Provisioning Service) es una función que permite configurar los clientes que vayan a enlazarse con un AP.
	- Los clientes que vayan a enlazarse podran hacerlo de dos maneras:
		- Introducir un PIN
		- Pulsar un botón para activar el "pairing mode".

	- Con WASH podremos detectar qué dispositivos (AP) cuentan con la funcionalidad de WPS activada.


       --------------------------------------------------------------------------------------------------------------------------------------------------------------
       | 2 | ¿Cómo utilizar Wash?																    |
       --------------------------------------------------------------------------------------------------------------------------------------------------------------

	El siguiente ejemplo realiza un "WPS discovery" y muestra el ESSID y BSSID del dispositivo:
	
	  >wash -I wlan0mon -C


#######################
## Kismet #############
#######################

       --------------------------------------------------------------------------------------------------------------------------------------------------------------
       | 1 | Breve descripción																	    |
       --------------------------------------------------------------------------------------------------------------------------------------------------------------
	
	- Kismet es un potente sniffer e IDS (intrusion detection system).
	- Es un "passive scanner" que escucha en una banda determinada, recopila paquetes 802.11 y detecta las redes que se encuentran activas.
	- También puede detectar redes no visibles.
	- Su arquitectura es CLIENTE/SERVIDOR:
		- Podemos tener un solo "Kismet Server" y varios "Kismet Clients" distribuidos que se encargan de recopilar datos que reportan al "Kismet Server".

	- Kismet cuenta con reglas predefinidas para la detección de "wireless attacks".
	- Los escaneos se guardan en ficheros: pcap.

       --------------------------------------------------------------------------------------------------------------------------------------------------------------
       | 2 | Configuración																	    |
       --------------------------------------------------------------------------------------------------------------------------------------------------------------

	Para configurar Kismet editaremos el fichero "kismet.conf" ubicado en: /etc/kismet/kismet.conf
	


#######################
## Wireshark ##########
#######################

       --------------------------------------------------------------------------------------------------------------------------------------------------------------
       | 1 | Breve descripción																	    |
       --------------------------------------------------------------------------------------------------------------------------------------------------------------

	- Very popular network analyzer tool widely used in the security domain.
	- Can be used to perform: 
		- Scan on wireless networks in order to discover access points (AP).

	- Doesn't create any "noise". 
